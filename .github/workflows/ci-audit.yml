k      - name: Run Lighthouse
        run: |
          if [ -f package.json ]; then
            npx lhci autorun --collect.staticDistDir=.next \
              --upload.target=filesystem \
              --upload.outputDir=./audit/lhci || true
          fi

      - name: Parse Lighthouse score
        run: |
          if [ -f audit/lhci/lhr-0.json ]; then
            perf=$(jq '.categories.performance.score * 100' audit/lhci/lhr-0.json)
            seo=$(jq '.categories.seo.score * 100' audit/lhci/lhr-0.json)
            a11y=$(jq '.categories.accessibility.score * 100' audit/lhci/lhr-0.json)
            echo "Perf: $perf, SEO: $seo, A11y: $a11y"
            # For bootstrap: only warn, donâ€™t fail
            if [ "$perf" -lt 90 ]; then echo "::warning::Performance below threshold ($perf < 90)"; fi
            if [ "$seo" -lt 90 ]; then echo "::warning::SEO below threshold ($seo < 90)"; fi
            if [ "$a11y" -lt 95 ]; then echo "::warning::Accessibility below threshold ($a11y < 95)"; fi
          else
            echo "No Lighthouse results found"
          fi

      - name: Dependency Scan (npm & pip)
        run: |
          if [ -f package.json ]; then npm audit --omit=dev || true; fi
          pip-audit || true

